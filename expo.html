<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mobile Game Concept</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Anton&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom styles for a more game-like feel */
        body {
            font-family: 'Inter', sans-serif;
            touch-action: manipulation; /* Disables double-tap zoom on mobile */
        }
        .font-anton {
            font-family: 'Anton', sans-serif;
        }
        .btn-glow:active {
            box-shadow: 0 0 20px rgba(59, 130, 246, 0.7);
        }
        .progress-bar-fill {
            transition: width 0.3s ease-in-out;
        }
        .emoji-red-stamp {
            /* This filter chain converts the emoji into a red silhouette and adds a glow */
            filter: grayscale(100%) brightness(40%) sepia(100%) hue-rotate(-50deg) saturate(600%) contrast(0.8) drop-shadow(0 0 8px rgba(139, 0, 0, 0.9));
        }
        .emoji-gold-glow {
            filter: drop-shadow(0 0 8px rgba(255, 215, 0, 0.8));
        }
    </style>
</head>
<body class="bg-gray-900 text-white flex items-center justify-center min-h-screen">

    <!-- Mobile Screen Container -->
    <div class="w-full max-w-sm h-[80vh] max-h-[700px] bg-gray-800 rounded-3xl shadow-2xl p-4 flex flex-col justify-between relative overflow-hidden">

        <!-- Top Section: Meters and Icons -->
        <div class="flex-shrink-0">
            <!-- Meter 1 Row -->
            <div class="flex items-center gap-2 mb-2">
                <div class="w-2/3 flex items-center h-6 text-2xl">
                    <span class="text-red-500">‚ù§Ô∏è</span>
                    <span class="font-bold ml-2">10</span>
                </div>
                <div class="flex items-center gap-3 text-lg">
                    <div class="flex items-center gap-1">
                        <span>‚ö™</span>
                        <span>10</span>
                    </div>
                    <div class="flex items-center gap-1">
                        <span>‚ö´</span>
                        <span>10</span>
                    </div>
                </div>
            </div>
            <!-- Meter 2 Row -->
            <div class="flex items-center gap-2 mb-3">
                 <div class="bg-gray-700 rounded-full h-6 w-2/3 border-2 border-gray-600">
                    <div id="meter2" class="bg-teal-800 h-full rounded-full progress-bar-fill" style="width: 50%"></div>
                </div>
                 <div class="flex items-center gap-3 text-lg">
                    <div class="flex items-center gap-1">
                        <span>üü°</span>
                        <span>10</span>
                    </div>
                    <div class="flex items-center gap-1">
                        <span>üî¥</span>
                        <span>10</span>
                    </div>
                </div>
            </div>

            <!-- Icon Row -->
            <div id="enemy-container" class="relative flex justify-around items-center bg-gray-900/50 rounded-lg p-2 select-none cursor-grab active:cursor-grabbing">
                <!-- The draggable slider window -->
                <div id="enemy-slider" class="absolute top-0 left-0 h-full bg-blue-500/20 border-2 border-blue-400 rounded-lg pointer-events-none" style="transition: transform 0.2s ease-out;"></div>

                <!-- Icons (z-10 to appear above the slider bg) - These will be populated by JS -->
                <span class="text-2xl relative z-10"></span>
                <span class="text-2xl relative z-10"></span>
                <span class="text-2xl relative z-10"></span>
                <span class="text-2xl relative z-10"></span>
                <span class="text-2xl relative z-10"></span>
                <span class="text-2xl relative z-10"></span>
                <span class="text-2xl relative z-10"></span>
                <span class="text-2xl relative z-10"></span>
            </div>
        </div>

        <!-- Middle Section: Game Windows & Grid -->
        <div class="flex-grow flex flex-col my-4 gap-3">
            <!-- Large Window Above -->
            <div class="bg-gray-700/50 rounded-lg flex-grow p-4 flex items-center justify-center text-gray-400 text-lg">
                <span>Large Display Area</span>
            </div>

            <!-- Lower area with side window and grid -->
            <div class="flex gap-3">
                <!-- Window to the left -->
                <div class="bg-gray-700/50 rounded-lg w-1/2 p-4 flex flex-col items-center justify-center text-gray-400 gap-2">
                     <span class="text-sm">Info Panel</span>
                </div>

                <!-- 3x3 Grid -->
                <div class="grid grid-cols-3 grid-rows-3 gap-2 w-1/2 aspect-square">
                    <!-- Row 1 (Equipment Slots) -->
                    <button class="equip-slot bg-blue-900 rounded-lg shadow-md focus:outline-none transition duration-150 ease-in-out active:bg-blue-800 btn-glow text-3xl flex items-center justify-center"></button>
                    <button class="equip-slot bg-blue-900 rounded-lg shadow-md focus:outline-none transition duration-150 ease-in-out active:bg-blue-800 btn-glow text-3xl flex items-center justify-center"></button>
                    <button class="equip-slot bg-blue-900 rounded-lg shadow-md focus:outline-none transition duration-150 ease-in-out active:bg-blue-800 btn-glow text-3xl flex items-center justify-center"></button>
                    <!-- Row 2 -->
                    <button class="bg-teal-800 rounded-lg shadow-md focus:outline-none transition duration-150 ease-in-out active:bg-teal-700 btn-glow text-3xl flex items-center justify-center">‚ù§Ô∏è‚Äçüî•</button>
                    <button class="bg-teal-800 rounded-lg shadow-md focus:outline-none transition duration-150 ease-in-out active:bg-teal-700 btn-glow text-3xl flex items-center justify-center">‚ùÑÔ∏è</button>
                    <button class="bg-teal-800 rounded-lg shadow-md focus:outline-none transition duration-150 ease-in-out active:bg-teal-700 btn-glow text-3xl flex items-center justify-center">üõ°Ô∏è</button>
                    <!-- Row 3 -->
                    <button id="fortunesBtn" class="bg-purple-500 rounded-lg text-3xl shadow-lg focus:outline-none transition duration-150 ease-in-out active:bg-purple-600 btn-glow flex items-center justify-center">üîÆ</button>
                    <button id="buildBtn" class="bg-gray-500 rounded-lg text-3xl shadow-lg focus:outline-none transition duration-150 ease-in-out active:bg-gray-600 btn-glow flex items-center justify-center">üî®</button>
                    <button id="shopBtn" class="bg-yellow-500 rounded-lg text-3xl shadow-lg focus:outline-none transition duration-150 ease-in-out active:bg-yellow-600 btn-glow flex items-center justify-center">ü™ô</button>
                </div>
            </div>
        </div>

        <!-- Bottom Navigation Bar -->
        <div class="flex-shrink-0 bg-gray-900/50 rounded-lg p-2">
            <div class="flex justify-around">
                <button id="reshuffleBtn" class="w-16 h-14 bg-gray-700 rounded-lg shadow-lg focus:outline-none transition duration-150 ease-in-out active:bg-gray-600 btn-glow flex items-center justify-center text-4xl">üîÉ</button>
                <button class="w-16 h-14 bg-red-600 rounded-lg shadow-lg focus:outline-none transition duration-150 ease-in-out active:bg-red-700 btn-glow flex items-center justify-center text-2xl text-white font-anton">üó°Ô∏è13</button>
                <button class="w-16 h-14 bg-gray-700 rounded-lg shadow-lg focus:outline-none transition duration-150 ease-in-out active:bg-gray-600 btn-glow"></button>
            </div>
        </div>

        <!-- MODAL WINDOWS -->
        <!-- Fortunes Modal -->
        <div id="fortunesModal" class="hidden absolute bottom-0 left-0 w-full h-1/2 bg-gray-800 rounded-t-2xl border-t-4 border-purple-500 p-4 flex flex-col justify-between items-center transition-transform duration-300 ease-in-out">
            <h2 class="text-2xl font-bold text-purple-400">Fortunes</h2>
            <div class="text-gray-300">Your fortunes await...</div>
            <button id="closeFortunes" class="bg-red-500 rounded-full w-12 h-12 flex items-center justify-center text-2xl shadow-lg focus:outline-none transition duration-150 ease-in-out active:bg-red-600 btn-glow">‚ùå</button>
        </div>

        <!-- Build Modal -->
        <div id="buildModal" class="hidden absolute bottom-0 left-0 w-full h-2/3 bg-gray-800 rounded-t-2xl border-t-4 border-gray-500 p-4 flex flex-col items-center transition-transform duration-300 ease-in-out">
            <h2 class="text-xl font-bold text-gray-300 mb-3">Build Equipment</h2>
            <div class="flex flex-col gap-4 w-full max-w-xs">
                <!-- Weapon Slot -->
                <div class="bg-gray-900 rounded-lg flex items-center justify-center p-3 w-full border-2 border-gray-600">
                    <span class="text-2xl mr-3">üó°Ô∏è</span>
                    <span class="font-anton text-white tracking-wider text-lg">DAGGER</span>
                </div>
                <!-- Armor Slot -->
                <div class="bg-gray-900 rounded-lg flex items-center justify-center p-3 w-full border-2 border-gray-600">
                    <span class="text-2xl mr-3">üß•</span>
                    <span class="font-anton text-white tracking-wider text-lg">LEATHERS</span>
                </div>
                <!-- Ring Slot -->
                <div class="bg-gray-900 rounded-lg flex items-center justify-center p-3 w-full border-2 border-gray-600">
                    <span class="text-2xl mr-3">üíç</span>
                    <span class="font-anton text-white tracking-wider text-lg">CONJURE STONE</span>
                </div>
            </div>
            <button id="closeBuild" class="absolute bottom-4 bg-red-500 rounded-full w-10 h-10 flex items-center justify-center text-xl shadow-lg focus:outline-none transition duration-150 ease-in-out active:bg-red-600 btn-glow">‚ùå</button>
        </div>

        <!-- Shop Modal -->
        <div id="shopModal" class="hidden absolute bottom-0 left-0 w-full h-2/3 bg-gray-800 rounded-t-2xl border-t-4 border-yellow-500 p-4 flex flex-col transition-transform duration-300 ease-in-out">
            <h2 class="text-lg font-bold text-yellow-400 mb-2 text-center flex-shrink-0">Shop</h2>
            <div class="flex-grow w-full max-w-xs mx-auto flex flex-col justify-around">
                <!-- Shop Item 1 -->
                <div class="flex justify-between items-center py-1.5 border-b border-gray-700">
                    <span class="text-xl">‚ù§Ô∏è</span>
                    <div class="flex-grow px-2">
                        <div class="font-semibold text-sm">Health Potion</div>
                        <div class="text-gray-400 text-xs">In Stock: 5</div>
                    </div>
                    <button class="bg-yellow-500 text-gray-900 font-bold text-xs px-2 py-1 rounded-full shadow-md hover:bg-yellow-400 active:bg-yellow-600 transition-all duration-150">
                        10 ü™ô
                    </button>
                </div>
                <!-- Shop Item 2 -->
                <div class="flex justify-between items-center py-1.5 border-b border-gray-700">
                    <span class="text-xl">üí£</span>
                    <div class="flex-grow px-2">
                        <div class="font-semibold text-sm">Bomb</div>
                        <div class="text-gray-400 text-xs">In Stock: 2</div>
                    </div>
                    <button class="bg-yellow-500 text-gray-900 font-bold text-xs px-2 py-1 rounded-full shadow-md hover:bg-yellow-400 active:bg-yellow-600 transition-all duration-150">
                        25 ü™ô
                    </button>
                </div>
                <!-- Shop Item 3 -->
                <div class="flex justify-between items-center py-1.5 border-b border-gray-700">
                    <span class="text-xl">üîë</span>
                    <div class="flex-grow px-2">
                        <div class="font-semibold text-sm">Dungeon Key</div>
                        <div class="text-gray-400 text-xs">In Stock: 1</div>
                    </div>
                    <button class="bg-yellow-500 text-gray-900 font-bold text-xs px-2 py-1 rounded-full shadow-md hover:bg-yellow-400 active:bg-yellow-600 transition-all duration-150">
                        50 ü™ô
                    </button>
                </div>
                <!-- Shop Item 4 -->
                <div class="flex justify-between items-center py-1.5 border-b border-gray-700">
                    <span class="text-xl">üíé</span>
                    <div class="flex-grow px-2">
                        <div class="font-semibold text-sm">Gem</div>
                        <div class="text-gray-400 text-xs">In Stock: 0</div>
                    </div>
                    <button class="bg-gray-600 text-gray-400 font-bold text-xs px-2 py-1 rounded-full shadow-md cursor-not-allowed" disabled>
                        100 ü™ô
                    </button>
                </div>
                <!-- Shop Item 5 -->
                <div class="flex justify-between items-center py-1.5 border-b border-gray-700">
                    <span class="text-xl">üìú</span>
                    <div class="flex-grow px-2">
                        <div class="font-semibold text-sm">Scroll</div>
                        <div class="text-gray-400 text-xs">In Stock: 10</div>
                    </div>
                    <button class="bg-yellow-500 text-gray-900 font-bold text-xs px-2 py-1 rounded-full shadow-md hover:bg-yellow-400 active:bg-yellow-600 transition-all duration-150">
                        15 ü™ô
                    </button>
                </div>
                <!-- Shop Item 6 -->
                <div class="flex justify-between items-center py-1.5">
                    <span class="text-xl">üé≤</span>
                    <div class="flex-grow px-2">
                        <div class="font-semibold text-sm">Lucky Dice</div>
                        <div class="text-gray-400 text-xs">In Stock: 3</div>
                    </div>
                    <button class="bg-yellow-500 text-gray-900 font-bold text-xs px-2 py-1 rounded-full shadow-md hover:bg-yellow-400 active:bg-yellow-600 transition-all duration-150">
                        30 ü™ô
                    </button>
                </div>
            </div>
            <button id="closeShop" class="absolute bottom-4 left-1/2 -translate-x-1/2 bg-red-500 rounded-full w-10 h-10 flex items-center justify-center text-xl shadow-lg focus:outline-none transition duration-150 ease-in-out active:bg-red-600 btn-glow">‚ùå</button>
        </div>


        <!-- Equipment Reel Modal -->
        <div id="reelModal" class="hidden absolute inset-0 bg-black/50 flex items-center justify-center z-50">
            <div class="relative bg-gray-900/80 backdrop-blur-sm rounded-xl p-3 shadow-xl border border-gray-700">
                <div id="reel-items" class="flex gap-2 text-3xl">
                    <button class="reel-item p-1 rounded-lg transition-transform hover:scale-110 active:scale-100">‚ò†Ô∏è</button>
                    <button class="reel-item p-1 rounded-lg transition-transform hover:scale-110 active:scale-100">üïØÔ∏è</button>
                    <button class="reel-item p-1 rounded-lg transition-transform hover:scale-110 active:scale-100">üêå</button>
                    <button class="reel-item p-1 rounded-lg transition-transform hover:scale-110 active:scale-100">‚ùáÔ∏è</button>
                    <button class="reel-item p-1 rounded-lg transition-transform hover:scale-110 active:scale-100">üåü</button>
                    <button class="reel-item p-1 rounded-lg transition-transform hover:scale-110 active:scale-100">‚ö°</button>
                </div>
                <button id="closeReel" class="absolute -top-3 -right-3 bg-red-600 rounded-full w-8 h-8 flex items-center justify-center text-lg font-bold transition-transform hover:scale-110 active:scale-100 shadow-lg">‚ùå</button>
            </div>
        </div>


    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Button and Modal mapping
            const modalMap = {
                'fortunesBtn': { modal: document.getElementById('fortunesModal'), close: document.getElementById('closeFortunes') },
                'buildBtn': { modal: document.getElementById('buildModal'), close: document.getElementById('closeBuild') },
                'shopBtn': { modal: document.getElementById('shopModal'), close: document.getElementById('closeShop') }
            };

            // Function to open a modal
            const openModal = (modal) => {
                if (modal) modal.classList.remove('hidden');
            };

            // Function to close a modal
            const closeModal = (modal) => {
                if (modal) modal.classList.add('hidden');
            };

            // Set up event listeners for all buttons
            for (const btnId in modalMap) {
                const button = document.getElementById(btnId);
                const { modal, close } = modalMap[btnId];
                
                if (button) {
                    button.addEventListener('click', () => openModal(modal));
                }
                if (close) {
                    close.addEventListener('click', () => closeModal(modal));
                }
            }
            
            // --- Equipment Reel Logic ---
            const reelModal = document.getElementById('reelModal');
            const closeReelBtn = document.getElementById('closeReel');
            const equipSlots = document.querySelectorAll('.equip-slot');
            const reelItems = document.querySelectorAll('.reel-item');
            let activeEquipSlot = null;

            // Open the reel when an empty equipment slot is clicked
            equipSlots.forEach(slot => {
                slot.addEventListener('click', () => {
                    activeEquipSlot = slot;
                    reelModal.classList.remove('hidden');
                });
            });

            // Function to close the reel
            const closeReel = () => {
                reelModal.classList.add('hidden');
                activeEquipSlot = null;
            }
            closeReelBtn.addEventListener('click', closeReel);

            // Handle selecting an item from the reel
            reelItems.forEach(item => {
                item.addEventListener('click', () => {
                    if (activeEquipSlot) {
                        // Check if another slot already has this item
                        let alreadyEquipped = false;
                        equipSlots.forEach(s => {
                            if (s.textContent === item.textContent && s !== activeEquipSlot) {
                                alreadyEquipped = true;
                            }
                        });

                        if (!alreadyEquipped) {
                             activeEquipSlot.textContent = item.textContent;
                             closeReel();
                        } else {
                            // Optional: provide feedback that item is already equipped
                            console.log("Item already equipped in another slot.");
                        }
                    }
                });
            });


            // --- Enemy Slider Logic ---
            const enemyContainer = document.getElementById('enemy-container');
            const enemySlider = document.getElementById('enemy-slider');
            const numIcons = 8;
            const groupSize = 3;
            let isDragging = false;
            let startX;
            let initialTranslateX;
            let currentTranslateX = 0;

            // Function to calculate dimensions and positions
            const calculateSliderDimensions = () => {
                const containerWidth = enemyContainer.offsetWidth;
                const iconWidth = containerWidth / numIcons;
                const sliderWidth = iconWidth * groupSize;
                enemySlider.style.width = `${sliderWidth}px`;
                return { containerWidth, iconWidth, sliderWidth };
            };
            calculateSliderDimensions(); // Initial calculation
            
            // Recalculate on window resize
            window.addEventListener('resize', calculateSliderDimensions);

            const getEventX = (e) => e.touches ? e.touches[0].clientX : e.clientX;

            const dragStart = (e) => {
                isDragging = true;
                startX = getEventX(e);
                enemySlider.style.transition = 'none'; // Disable transition while dragging
                initialTranslateX = currentTranslateX;
                document.addEventListener('mousemove', dragMove);
                document.addEventListener('touchmove', dragMove);
                document.addEventListener('mouseup', dragEnd);
                document.addEventListener('touchend', dragEnd);
            };

            const dragMove = (e) => {
                if (!isDragging) return;
                e.preventDefault();
                const currentX = getEventX(e);
                const deltaX = currentX - startX;
                currentTranslateX = initialTranslateX + deltaX;
                
                // Clamp the movement within bounds
                const { containerWidth, sliderWidth } = calculateSliderDimensions();
                const maxTranslateX = containerWidth - sliderWidth;
                currentTranslateX = Math.max(0, Math.min(currentTranslateX, maxTranslateX));

                enemySlider.style.transform = `translateX(${currentTranslateX}px)`;
            };

            const dragEnd = () => {
                if (!isDragging) return;
                isDragging = false;
                enemySlider.style.transition = 'transform 0.2s ease-out'; // Re-enable transition for snapping

                const { iconWidth } = calculateSliderDimensions();
                // Find the closest snap point (which icon index we are closest to)
                const closestSnapIndex = Math.round(currentTranslateX / iconWidth);
                // Clamp snap index to possible values (0 to 5 for 8 icons in groups of 3)
                const clampedIndex = Math.min(numIcons - groupSize, Math.max(0, closestSnapIndex));
                
                currentTranslateX = clampedIndex * iconWidth;
                enemySlider.style.transform = `translateX(${currentTranslateX}px)`;

                document.removeEventListener('mousemove', dragMove);
                document.removeEventListener('touchmove', dragMove);
                document.removeEventListener('mouseup', dragEnd);
                document.removeEventListener('touchend', dragEnd);
            };

            enemyContainer.addEventListener('mousedown', dragStart);
            enemyContainer.addEventListener('touchstart', dragStart);

            // --- Enemy Reshuffle Logic ---
            const reshuffleBtn = document.getElementById('reshuffleBtn');
            const enemySpans = enemyContainer.querySelectorAll('span');
            
            // A larger pool of enemies to pull from for variety
            const enemyPool = ['üê≤', 'üëπ', 'üëª', 'üíÄ', 'üï∑Ô∏è', 'üêç', 'üßü', 'üßõ', 'üëΩ', 'ü§ñ', 'ü¶Ç', 'üë∫'];
            const giftEmoji = 'üéÅ';

            // Fisher-Yates shuffle function to randomize array order
            function shuffle(array) {
                let currentIndex = array.length, randomIndex;
                while (currentIndex > 0) {
                    randomIndex = Math.floor(Math.random() * currentIndex);
                    currentIndex--;
                    [array[currentIndex], array[randomIndex]] = [array[randomIndex], array[currentIndex]];
                }
                return array;
            }

            function reshuffleEnemies() {
                // 1. Create a new set of 7 random enemies from the pool
                const shuffledPool = shuffle([...enemyPool]);
                const currentEnemies = shuffledPool.slice(0, 7);
                // 2. Add the gift, so we always have one
                currentEnemies.push(giftEmoji);
                
                // 3. Shuffle the final set of 8 that will be displayed
                const finalEnemySet = shuffle(currentEnemies);

                // 4. Update the spans with the new emojis and reset their styles
                enemySpans.forEach((span, index) => {
                    span.textContent = finalEnemySet[index];
                    span.className = 'text-2xl relative z-10'; // Reset classes
                });

                const allSpans = Array.from(enemyContainer.querySelectorAll('span'));

                // 5. Always apply the gold glow style to the gift emoji
                const giftSpan = allSpans.find(span => span.textContent === giftEmoji);
                if (giftSpan) {
                    giftSpan.classList.add('emoji-gold-glow');
                }

                // 6. Filter out the gift, then pick one random enemy to make red
                const stampableSpans = allSpans.filter(span => span.textContent !== giftEmoji);
                if (stampableSpans.length > 0) {
                    const randomEnemyToStamp = stampableSpans[Math.floor(Math.random() * stampableSpans.length)];
                    randomEnemyToStamp.classList.add('emoji-red-stamp');
                }
            }

            if (reshuffleBtn && enemySpans.length > 0) {
                // Add the click listener to the reshuffle button
                reshuffleBtn.addEventListener('click', reshuffleEnemies);
                
                // Perform an initial shuffle on page load
                reshuffleEnemies();
            }
        });
    </script>

</body>
</html>
